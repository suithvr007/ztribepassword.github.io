<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Password Vault</title>

  <!-- Firebase -->
  <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // // Your web app's Firebase configuration
  // // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  // const firebaseConfig = {
  //   apiKey: "AIzaSyAdQXobYdViArKQqLn2GYa1hzzhPU2YTwI",
  //   authDomain: "zebrapassword.firebaseapp.com",
  //   projectId: "zebrapassword",
  //   storageBucket: "zebrapassword.firebasestorage.app",
  //   messagingSenderId: "326302828139",
  //   appId: "1:326302828139:web:8f1a856fde52b26fb5d32e",
  //   measurementId: "G-G1NNTMSGE6"
  // };

  // // Initialize Firebase
  // const app = initializeApp(firebaseConfig);
  // const analytics = getAnalytics(app);
</script>

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <!-- Styling -->
  <style>
    :root {
      --bg: #f0f2f5;
      --primary: #2c3e50;
      --accent: #3498db;
      --card: #ffffff;
      --danger: #e74c3c;
      --shadow: rgba(0, 0, 0, 0.1);
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: var(--bg);
      color: var(--primary);
      padding: 2rem;
    }

    .container {
      max-width: 900px;
      margin: auto;
      background: var(--card);
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px var(--shadow);
    }

    h2 {
      text-align: center;
      margin-bottom: 2rem;
    }

    #login {
      text-align: center;
    }

    input, button {
      padding: 10px;
      font-size: 1rem;
      margin: 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    button {
      background: var(--accent);
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover {
      background: #2b7bbd;
    }

    #loginError {
      color: var(--danger);
      margin-top: 1rem;
    }

    #dashboard {
      display: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
    }

    th, td {
      padding: 12px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }

    th {
      background: var(--primary);
      color: white;
    }

    td input {
      width: 100%;
      padding: 8px;
    }

    .form-inline {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 1.5rem;
    }

    .form-inline input {
      flex: 1;
      min-width: 150px;
    }

    .icon {
      margin-right: 6px;
    }

    @media (max-width: 600px) {
      .form-inline {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

  <div class="container">
    <h2><i class="fas fa-lock icon"></i> Password Vault</h2>

    <div id="login">
      <input type="password" id="loginKey" placeholder="Enter Access Key" />
      <br>
      <button onclick="checkLogin()"><i class="fas fa-sign-in-alt icon"></i> Login</button>
      <p id="loginError"></p>
    </div>

    <div id="dashboard">
      <h3><i class="fas fa-database icon"></i> Saved Credentials</h3>

      <div class="form-inline">
        <input type="text" id="newWebsite" placeholder="Website" />
        <input type="text" id="newUsername" placeholder="Username" />
        <input type="text" id="newPassword" placeholder="Password" />
        <input type="text" id="newLink" placeholder="Website Link" />
        <button onclick="addAccount()">Add</button>
      </div>

      <table id="dataTable">
        <thead>
          <tr>
            <th>Website</th>
            <th>Username</th>
            <th>Password</th>
            <th>Link</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    // Replace with your own Firebase config
    const firebaseConfig = {
    apiKey: "AIzaSyAdQXobYdViArKQqLn2GYa1hzzhPU2YTwI",
    authDomain: "zebrapassword.firebaseapp.com",
    projectId: "zebrapassword",
    storageBucket: "zebrapassword.firebasestorage.app",
    messagingSenderId: "326302828139",
    appId: "1:326302828139:web:8f1a856fde52b26fb5d32e",
    measurementId: "G-G1NNTMSGE6"
    };
    console.log("Connecting to Firebase...");
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    console.log("Firebase connected");

    const MASTER_KEY = "zebra"; // Change this securely!

    function checkLogin() {
      const key = document.getElementById("loginKey").value;
      if (key == MASTER_KEY) {
        document.getElementById("login").style.display = "none";
        document.getElementById("dashboard").style.display = "block";
        loadData();
      } else {
        document.getElementById("loginError").innerText = "Invalid access key!";
      }
    }

    function loadData() {
      const tbody = document.querySelector("#dataTable tbody");
      db.collection("accounts").onSnapshot(snapshot => {
        tbody.innerHTML = "";
        snapshot.forEach(doc => {
          const data = doc.data();
          const tr = document.createElement("tr");

          tr.innerHTML = `
            <td>${data.website}</td>
            <td>${data.username}</td>
            <td>
              <input type="text" value="${data.password}" onchange="updatePassword('${doc.id}', this.value)" />
            </td>
            <td><a href="${data.link}" target="_blank"><i class="fas fa-external-link-alt"></i> Visit</a></td>
          `;

          tbody.appendChild(tr);
        });
      });
    }

    function updatePassword(docId, newPassword) {
      db.collection("accounts").doc(docId).update({ password: newPassword })
        .then(() => console.log("Password updated"))
        .catch(err => console.error("Update error:", err));
    }

    function addAccount() {
      const website = document.getElementById("newWebsite").value;
      const username = document.getElementById("newUsername").value;
      const password = document.getElementById("newPassword").value;
      const link = document.getElementById("newLink").value;

      if (website && username && password && link) {
        db.collection("accounts").add({ website, username, password, link })
          .then(() => {
            document.getElementById("newWebsite").value = "";
            document.getElementById("newUsername").value = "";
            document.getElementById("newPassword").value = "";
            document.getElementById("newLink").value = "";
          })
          .catch(err => console.error("Add error:", err));
      } else {
        alert("Please fill all fields.");
      }
    }
  </script>

</body>
</html>
